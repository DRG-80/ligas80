<app-header></app-header>

<div class="container mt-5 mb-5" style="min-height: 60vh;">

  <!-- TÍTULO -->
  <div class="text-center mb-4 animate__animated animate__fadeIn">
    <h2 class="fw-bold text-uppercase" style="color: #FF383C; text-shadow: 1px 1px 0px #000;">
      Mercado de Agentes Libres
    </h2>
    <h3 class="text-dark">
      Presupuesto: <span class="fw-bold text-success">{{ presupuesto | currency:'EUR':'symbol':'1.0-0' }}</span>
    </h3>    <p class="text-muted">Ficha a los mejores jugadores para tu equipo</p>
  </div>

  <!-- CONTENIDO (Solo si tiene permiso) -->
  <div *ngIf="pertenencia" class="card shadow p-4 border-0 animate__animated animate__fadeInUp">

    <div class="table-responsive">
      <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-hover w-100 tabla-fichajes">

        <!-- Cabecera Corporativa -->
        <thead class="thead-corporativo">
        <tr>
          <th>Jugador</th>
          <th class="text-center">Posición</th>
          <th class="text-center">Media</th>
          <th class="text-end">Valor de Mercado</th>
          <th class="text-center" style="width: 120px;">Acción</th>
        </tr>
        </thead>

        <tbody>
        <tr *ngFor="let j of jugadores">
          <!-- Nombre y Apellidos -->
          <td class="align-middle">
            <span class="fw-bold" style="color: #FF383C;">{{ j.nombre }}</span>
            <span class="text-dark ms-1">{{ j.apellidos }}</span>
          </td>

          <!-- Posición con colores (Lógica en línea) -->
          <td class="text-center align-middle">
              <span class="badge" [ngClass]="{
                'bg-warning text-dark': j.posicion === 'POR',
                'bg-info text-dark': j.posicion === 'DEF',
                'bg-success': j.posicion === 'MED' || j.posicion === 'MC',
                'bg-danger': j.posicion === 'DEL'
              }">
                {{ j.posicion }}
              </span>
          </td>

          <!-- Media -->
          <td class="text-center align-middle fw-bold fs-5">{{ j.media }}</td>

          <!-- Precio -->
          <td class="text-end align-middle font-monospace text-success fw-bold">
            {{ j.precio | currency:'EUR':'symbol':'1.0-0' }}
          </td>

          <!-- Botón Fichar (Estilo Negro/Rojo) -->
          <td class="text-center align-middle">
            <button class="btn btn-nuevoEquipo btn-sm" (click)="ficharJugador(j.id)">
              <i class="bi bi-cart-plus"></i> Fichar
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- Mensaje si no tiene permiso (opcional, por si falla la redirección) -->
  <div *ngIf="!pertenencia" class="text-center mt-5">
    <div class="spinner-border text-danger" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

</div>

<app-footer></app-footer>
