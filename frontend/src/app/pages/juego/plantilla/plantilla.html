<app-header></app-header>

<div class="container mt-4 mb-5" *ngIf="pertenencia">


  <div *ngIf="cargando" class="text-center mt-5 mb-5 d-flex flex-column align-items-center justify-content-center" style="min-height: 50vh;">
    <div class="spinner-border text-danger" style="width: 4rem; height: 4rem;" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <h4 class="mt-3 text-muted fw-bold">Cargando alineacion...</h4>
  </div>


  <div *ngIf="!cargando" class="animate__animated animate__fadeIn">

    <div class="d-flex justify-content-end mb-3">
      <button class="btn btn-danger fw-bold shadow" (click)="guardarAlineacion()">
        <i class="bi bi-save"></i> Guardar Alineación
      </button>
    </div>

    <div class="campo-futbol mb-4 shadow border-white border-3">

      <div class="linea-campo">
        <div cdkDropList id="lista-delanteros"
             [cdkDropListData]="delanteros"
             [cdkDropListConnectedTo]="['lista-medios', 'lista-defensas', 'lista-portero', 'lista-banquillo']"
             class="zona-drop"
             (cdkDropListDropped)="drop($event)">

          <div class="ficha-jugador" *ngFor="let j of delanteros" cdkDrag [cdkDragData]="j">
            <div class="media bg-danger">{{ j.media }}</div>
            <div class="nombre">{{ j.nombre }}</div>
          </div>
          <span *ngIf="delanteros.length === 0" class="placeholder-text">DEL (3)</span>
        </div>
      </div>

      <div class="linea-campo">
        <div cdkDropList id="lista-medios" [cdkDropListData]="medios" [cdkDropListConnectedTo]="['lista-delanteros', 'lista-defensas', 'lista-portero', 'lista-banquillo']" class="zona-drop" (cdkDropListDropped)="drop($event)">
          <div class="ficha-jugador" *ngFor="let j of medios" cdkDrag [cdkDragData]="j">
            <div class="media bg-success">{{ j.media }}</div>
            <div class="nombre">{{ j.nombre }}</div>
          </div>
          <span *ngIf="medios.length === 0" class="placeholder-text">MED (3)</span>
        </div>
      </div>

      <div class="linea-campo">
        <div cdkDropList id="lista-defensas" [cdkDropListData]="defensas" [cdkDropListConnectedTo]="['lista-delanteros', 'lista-medios', 'lista-portero', 'lista-banquillo']" class="zona-drop" (cdkDropListDropped)="drop($event)">
          <div class="ficha-jugador" *ngFor="let j of defensas" cdkDrag [cdkDragData]="j">
            <div class="media bg-primary">{{ j.media }}</div>
            <div class="nombre">{{ j.nombre }}</div>
          </div>
          <span *ngIf="defensas.length === 0" class="placeholder-text">DEF (4)</span>
        </div>
      </div>

      <div class="linea-campo">
        <div cdkDropList id="lista-portero" [cdkDropListData]="portero" [cdkDropListConnectedTo]="['lista-delanteros', 'lista-medios', 'lista-defensas', 'lista-banquillo']" class="zona-drop" (cdkDropListDropped)="drop($event)">
          <div class="ficha-jugador portero" *ngFor="let j of portero" cdkDrag [cdkDragData]="j">
            <div class="media bg-warning text-dark">{{ j.media }}</div>
            <div class="nombre">{{ j.nombre }}</div>
          </div>
          <span *ngIf="portero.length === 0" class="placeholder-text">POR (1)</span>
        </div>
      </div>

    </div>

    <div class="bg-light p-3 rounded shadow-sm mb-5">
      <h4 class="text-center mb-3">Banquillo</h4>

      <div cdkDropList id="lista-banquillo"
           [cdkDropListData]="banquillo"
           [cdkDropListConnectedTo]="['lista-delanteros', 'lista-medios', 'lista-defensas', 'lista-portero']"
           class="row g-2 lista-banquillo"
           (cdkDropListDropped)="drop($event)">

        <div class="col-6 col-md-3 col-lg-2" *ngFor="let j of banquillo" cdkDrag [cdkDragData]="j">
          <div class="card shadow-sm border-0 player-card">
            <div class="card-body p-2 text-center">
              <span class="badge bg-dark mb-1">{{ j.posicion }}</span>
              <h6 class="card-title fw-bold text-truncate" style="font-size: 0.9rem;">{{ j.nombre }}</h6>
              <div class="fw-bold text-danger">{{ j.media }}</div>
            </div>
          </div>
        </div>

        <div *ngIf="banquillo.length === 0" class="col-12 text-center py-5 empty-bench-message">
          <i class="bi bi-arrow-down-circle fs-2 text-muted"></i>
          <p class="text-muted fw-bold mt-2">Suelta aquí para devolver al banquillo</p>
        </div>

      </div>
    </div>

  </div>

</div>

<app-footer></app-footer>
